<div class="personal-data-container">
  <div class="personal-data-content">
    <div class="logo-header">
      <img src="assets/logo_resuelve.png" alt="Resuelve Logo" class="logo" />
    </div>

    <app-progress-indicator [currentStep]="2" [totalSteps]="6"></app-progress-indicator>

    <div class="form-header">
      <h1>Confirma tus datos</h1>
      <p class="subtitle">Verifica que tu información sea correcta</p>
    </div>

    <form [formGroup]="personalDataForm" (ngSubmit)="onSubmit()" class="personal-data-form">
      
      <div class="section-header">
        <h3>Datos personales</h3>
        <span class="badge">Prellenado</span>
      </div>

      <div class="form-group">
        <label for="fullName">Nombre completo</label>
        <input 
          type="text" 
          id="fullName" 
          formControlName="fullName"
          class="locked-field"
        />
        <span class="field-info">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M13 16H12V12H11M12 8H12.01M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Obtenido de fuentes externas
        </span>
      </div>

      <!-- <div class="form-group">
        <label for="birthDate">Fecha de nacimiento</label>
        <input 
          type="date" 
          id="birthDate" 
          formControlName="birthDate"
          class="locked-field"
        />
      </div> -->

      <div class="section-header">
        <h3>Contacto</h3>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="phone">Teléfono <span class="required">*</span></label>
          <input 
            type="tel" 
            id="phone" 
            formControlName="phone"
            placeholder="09X-XXX-XXXX"
            [class.error]="phone?.invalid && phone?.touched"
          />
          <div class="error-message" *ngIf="phone?.invalid && phone?.touched">
            <span *ngIf="phone?.errors?.['required']">El teléfono es requerido</span>
            <span *ngIf="phone?.errors?.['pattern']">Ingresa un teléfono válido de 10 dígitos</span>
          </div>
        </div>

        <div class="form-group">
          <label for="email">Correo electrónico <span class="required">*</span></label>
          <input 
            type="email" 
            id="email" 
            formControlName="email"
            placeholder="tu@email.com"
            [class.error]="email?.invalid && email?.touched"
          />
          <div class="error-message" *ngIf="email?.invalid && email?.touched">
            <span *ngIf="email?.errors?.['required']">El correo es requerido</span>
            <span *ngIf="email?.errors?.['email']">Ingresa un correo válido</span>
          </div>
        </div>
      </div>

      <div class="section-header">
        <h3>Dirección</h3>
      </div>

      <div class="form-group">
        <label for="address">Dirección principal <span class="required">*</span></label>
        <input 
          type="text" 
          id="address" 
          formControlName="address"
          placeholder="Calle, número, apartamento"
          [class.error]="address?.invalid && address?.touched"
        />
        <div class="error-message" *ngIf="address?.invalid && address?.touched">
          <span *ngIf="address?.errors?.['required']">La dirección es requerida</span>
        </div>
      </div>

      <div class="form-group">
        <label for="city">Ciudad</label>
        <input 
          type="text" 
          id="city" 
          formControlName="city"
          class="locked-field"
        />
      </div>

      <div class="form-actions">
        <button type="button" class="btn-secondary" (click)="onGoBack()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M19 12H5M5 12L12 19M5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Atrás
        </button>
        <button type="submit" class="btn-primary">
          Confirmar y continuar
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>
      <div class="cancel-section">
        <button type="button" class="btn-link-cancel" (click)="openCancelModal()">
          Cancelar solicitud
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Modal de confirmación de cancelación -->
@if (showCancelModal()) {
  <div class="modal-overlay" (click)="closeCancelModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>¿Estás seguro de cancelar la solicitud?</h2>
      </div>
      <div class="modal-body">
        <p>Guardaremos tu solicitud por si la quieres continuar en el futuro.</p>
      </div>
      <div class="modal-actions">
        <button type="button" class="btn-secondary" (click)="closeCancelModal()">
          No, volver
        </button>
        <button type="button" class="btn-primary-danger" (click)="confirmCancel()">
          Sí, cancelar
        </button>
      </div>
    </div>
  </div>
}
